@page
@model The_Post.Areas.Identity.Pages.Account.Manage.NewslettersModel

@{
    ViewData["Title"] = "Newsletters";
    ViewData["ActivePage"] = ManageNavPages.Newsletters;
}

<h3>My Personalized Newsletter</h3>

<form method="post" asp-page-handler="save">
    <div class="form-group m-2">
        <label>Include Editors' Choice:</label>
        <div class="form-check form-switch">
            <!-- Hidden input to ensure false is sent if checkbox is unchecked -->
            @* <input type="hidden" name="EditorsChoiceSelection" value="false" /> *@
            <input class="form-check-input" type="checkbox" asp-for="EditorsChoiceSelection" value="true" checked="@Model.EditorsChoiceSelection" />
        </div>

        <label>Choose categories to include:</label>
        @foreach (var category in Model.AvailableCategories)
        {
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" name="SelectedCategoryIds" value="@category.Value"
                @(Model.SelectedCategoryIds.Contains(int.Parse(category.Value)) ? "checked" : "") /> <!--If a user has saved a category before, it is reflected here-->
                <label class="form-check-label">@category.Text</label>
            </div>
        }
        <div class="form-group mt-3">
            <input type="submit" value="Save Changes" class="btn btn-primary" />
        </div>
    </div>
</form>


<script>
        // Toastr Message if saving was successful or not
    document.addEventListener("DOMContentLoaded", function () {
        var successMessage = '@TempData["SuccessMessage"]';
        var errorMessage = '@TempData["ErrorMessage"]';

        if (successMessage) {
            toastr.success(successMessage);
        }

        if (errorMessage) {
            toastr.error(errorMessage);
        }
    });
</script>