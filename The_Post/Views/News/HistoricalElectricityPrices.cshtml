@* @model List<Azure.Data.Tables.TableEntity> *@
    @model The_Post.Models.VM.HistoricalElectricityPricesViewModel

@{
    ViewData["Title"] = "Historical Electricity Prices";
}

<h2>@ViewData["Title"]</h2>

@if (Model.ErrorOccurred)
{
    <div class="alert alert-danger">
        <strong>Error:</strong> There was an issue retrieving the data.
    </div>
}
else if (Model.NoHistoricalData)
{
    <div class="alert alert-warning">
        No historical data found for the selected date range.
    </div>
}
else
{
    <h3 style="color:#0A2472">Choose Date</h3>
    <form method="get" action="@Url.Action("HistoricalElectricityPrices", "News")">
        <label for="datePicker">Select a Date:</label>
        <input type="date" id="datePicker" name="date" value="@DateTime.Now.AddDays(-1).ToString("yyyy-MM-dd")" required />
        <button type="submit">Get Prices</button>
    </form>
  <h3>SE1 Region</h3>
 
        <table class="table table-dark table-hover table-bordered table-sm">
            <thead>
                <tr>
                    <th>Hour</th>
                    <th>Price (SEK)</th>
                     <th>Date</th> 
                </tr>
            </thead>
            <tbody>
            @foreach (var price in Model.ElectricityPrices.Where(p => p.RowKey.StartsWith("SE1")))
                {
                    <tr>
                        <td>@price.RowKey.Substring(4)</td>
                        <td>@price["price_sek"]</td>
                         <td>@price.PartitionKey</td> 
                    </tr>
                }
            </tbody>
        </table>
 
  
    <!-- Table for SE2 -->
    <h3>SE2 Region</h3>
     <table class="table table-dark table-hover table-bordered table-sm">
            <thead>
                <tr>
                    <th>Hour</th>
                    <th>Price (SEK)</th>
                      <th>Date</th>  
                </tr>
            </thead>
            <tbody>
            @foreach (var price in Model.ElectricityPrices.Where(p => p.RowKey.StartsWith("SE2")).GroupBy(p => new { p.RowKey, p.PartitionKey })
           .Select(g => g.First()))
                {
                    <tr>
                    <td>@price.RowKey.Substring(4)</td>
                        <td>@price["price_sek"]</td>
                          <td>@price.PartitionKey</td>  
                    </tr>
                }
            </tbody>
        </table>
    
 

    <!-- Table for SE3 -->
    <h3>SE3 Region</h3>
   
        <table class="table table-dark table-hover table-bordered table-sm">
            <thead>
                <tr>
                    <th>Hour</th>
                    <th>Price (SEK)</th>
                      <th>Date</th>  
                </tr>
            </thead>
            <tbody>
            @foreach (var price in Model.ElectricityPrices.Where(p => p.RowKey.StartsWith("SE3")).GroupBy(p => new { p.RowKey, p.PartitionKey })
           .Select(g => g.First()))
                {
                    <tr>
                    <td>@price.RowKey.Substring(4)</td>
                        <td>@price["price_sek"]</td>
                         <td>@price.PartitionKey</td>  
                    </tr>
                }
            </tbody>
        </table>
    
   

    <!-- Table for SE4 -->
    <h3>SE4 Region</h3>
   
        <table class="table table-dark table-hover table-bordered table-sm">
            <thead>
                <tr>
                    <th>Hour</th>
                    <th>Price (SEK)</th>
                     <th>Date</th>  
                </tr>
            </thead>
            <tbody>
            @foreach (var price in Model.ElectricityPrices.Where(p => p.RowKey.StartsWith("SE4")).GroupBy(p => new { p.RowKey, p.PartitionKey })
           .Select(g => g.First()))
                {
                    <tr>
                        <td>@price.RowKey</td>
                        <td>@price["price_sek"]</td>
                         <td>@price.PartitionKey</td> 
                    </tr>
                }
            </tbody>
        </table>
    
    }
  

